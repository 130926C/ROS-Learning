## demo 42

仿真环境下的机器人导航（路径规划）

在ROS的navigation功能包中集成了move_base 功能包，以此来实现路径规划。

-----

### move_base 简介
move_base 提供了基于动作（ros action）的路径规划，可以根据指定的目标点控制机器人底盘运动至目标位置，并且在运动过程中会持续反馈机器人当前的状态（因为action是可以持续反馈的），move_base主要由 **全局路径规划** 和 **本地路径规划** 两大部分组成。


【题外话】因为赵虚左的课程中将 ros action 放到了比较后面的位置，但我这里在 demo31 的时候就引入了 action 的内容，这部分东西和 msg、srv 非常相似，所以这里仍然建议的是按照demo的顺序结合赵虚左的课程执行下去，如果遇到了课程中没有的也不要跳跃，因为后面会用到。

-----

### move_base 代价地图

1. 在之前的demo中已经可以使用 SLAM 来创建全局地图了，但在导航过程中这种静态地图是不可用的，因为障碍物可能出现增减，因此需要实时获取障碍物信息。
2. 机器人通过一个障碍物时以不同的方式运动会有不同的代价，即一定发生碰撞、可能发生碰撞、一定不会发生碰撞。

因此最好是在障碍物附近设置一定的**膨胀区**来阻止机器人进入。

同路径规划一样，代价地图也分为 **全局代价地图** 和 **本地代价地图**。

一张代价地图通常有多层叠加：
1. 静态层；--- SLAM 绘制的静态地图
2. 障碍物层； --- 导航中传感器感知的障碍物
3. 膨胀层； --- 为了避免碰撞而设计的安全区
4. 自定义层； --- 根据业务自己设置的一些地图数据

其中自定义层是指在导航过程中可以添加一堵虚拟强来让机器人规避一段区域，这个墙在现实中或者 SLAM 建模过程中都没出现过。

----

### 碰撞算法

此处可以直接看赵虚左的知乎专栏 [ROS入门教程-理论与实践（7.2.4 导航实现04_路径规划）](https://zhuanlan.zhihu.com/p/364310614)，

![碰撞代价](images/collision_cost.jpg)

-----

### move_base 使用

因为 move_base 被设计用来适应多种不同类型的机器人，机器人之间的尺寸、质量、传感器类型、速度、场景均可能不同，这些都会影响到路径规划结果，因此需要在使用之前将自己的机器人数据配置进去。

1. 编写launch文件模板；
2. 编写配置文件；
3. 集成和导航相关的launch文件；
4. 运行；

1：35

https://www.bilibili.com/video/BV1Ci4y1L7ZZ?p=312&spm_id_from=pageDriver&vd_source=c8dbe5ab3b4bf743fae13d455b4aa039 